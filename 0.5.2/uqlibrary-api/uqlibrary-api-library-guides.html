<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../core-ajax/core-ajax.html">
<link rel="import" href="uqlibrary-api.html">

<!--
Element providing library guides

##### Example

    <uqlibrary-api-library-guides></uqlibrary-api-library-guides>

@element uqlibrary-api-library-guides
@blurb Element providing library guides.
@status alpha
@homepage https://github.com/uqlibrary/uqlibrary-api
-->
<polymer-element name="uqlibrary-api-library-guides" extends="uqlibrary-api">

  <template>
    <uqlibrary-api id="list"></uqlibrary-api>
  </template>

  <script>
    (function() {
      Polymer('uqlibrary-api-library-guides', {


        baseUri : '/library_guides',
        subjectCode : '',

        /**
         * Fired when the object has loaded.
         *
         * @event uqlibrary-api-library-guides
         */
        created: function () {
        },

        ready: function () {
          var that = this;
          this.$.list.mockDataFileUrl = this.tagName.toLowerCase();
          this.$.list.addEventListener('uqlibrary-api', function(e) {
            if(e.detail.hasOwnProperty('status') && e.detail.status != 200) {
              that.list = [];
            }
            else {
              //Check is mocked data is loaded
              if(e.detail.hasOwnProperty('mock')){
                if(e.detail.data.hasOwnProperty(that.subjectCode)){
                  that.list = e.detail.data[that.subjectCode];
                }
              }
              else {
                that.list = e.detail;
              }
            }
            that.fire('uqlibrary-api-library-guides', that.list);
          });
        },

        /**
         * Gets learning resources.
         *
         * @method get
         */
        get: function (args) {

          if (args && args.code){
            this.subjectCode = args.code;
            this.$.list.uri = this.baseUri + "/" + args.code;
            this.$.list.get();
          }


        }
      });
    })();
  </script>

</polymer-element>
